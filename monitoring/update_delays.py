import numpy

NTPMs = 16

# put OLD delays here:
a = []
delta_delay = []
for i in range(0,NTPMs):
   a.append(None)
   delta_delay.append(None)
   
a[0] = [5, 5, 3, 3, 0, 0, 4, 4, 4, 4, 3, 3, 4, 4, 4, 4, 5, 5, 10, 10, 0, 0, 2, 2, 6, 6, 7, 7, 3, 3, 2, 2]
a[1] = [4, 4, 1, 1, 0, 0, 1, 1, 1, 1, 3, 3, 1, 1, 1, 1, 2, 2, 2, 2, 1, 1, 1, 1, 2, 2, 4, 4, 2, 2, 4, 4]
a[2] = [4, 4, 3, 3, 1, 1, 0, 0, 7, 7, 5, 5, 6, 6, 7, 7, 4, 4, 1, 1, 8, 8, 4, 4, 12, 12, 4, 4, 3, 3, 2, 2]
a[3] = [-25, -25, -29, -29, -31, -31, -31, -31, -28, -28, -29, -29, -29, -29, -30, -30, -27, -27, -28, -28, -30, -30, -30, -30, -27, -27, -26, -26, -28, -28, -29, -29]
a[4] = [9, 9, 13, 13, 15, 15, 12, 12, 9, 9, 5, 5, 8, 8, 10, 10, 5, 5, 8, 8, 9, 9, 6, 6, 21, 21, 11, 11, 9, 9, 7, 7]
a[5] = [9, 9, 11, 11, 6, 6, 10, 10, 6, 6, 5, 5, 119, 119, 5, 5, 10, 10, 8, 8, 8, 8, 6, 6, 13, 13, 10, 10, 9, 9, 8, 8]
a[6] = [88, 88, 76, 76, 76, 76, 74, 74, 81, 81, 77, 77, 76, 76, 78, 78, 78, 78, 81, 81, 74, 74, 75, 75, 80, 80, 78, 78, 76, 76, 75, 75]
a[7] = [74, 74, 72, 72, 71, 71, 73, 73, 74, 74, 75, 75, 74, 74, 75, 75, 77, 77, 78, 78, 72, 72, 72, 72, 80, 80, 78, 78, 72, 72, 74, 74]    
a[8] = [8,  8,  5,  5,  9,  9,  4,  4,  4,  4, 12, 12, 15, 15, 13, 13,  5, 5,  6,  6,  4,  4,  6,  6,  9,  9,  8,  8,  6,  6,  5,  5]    
a[9] = [22, 22, 20, 20, 24, 24, 19, 19, 23, 23, 21, 21, 21, 21, 24, 24, 19, 19, 21, 21, 19, 19, 20, 20, 24, 24, 23, 23,  0,  0, 11, 11]
a[10] = [-35, -35, -33, -33, -38, -38, -35, -35, -36, -36, -40, -40, -37, -37, -35, -35, -35, -35, -37, -37, -36, -36, -38, -38, -22, -22, -36, -36, -38, -38, -37, -37]
a[11] = [-29, -29, -39, -39, -40, -40, -43, -43, -41, -41, -41, -41, -40, -40, -42, -42, -38, -38, -34, -34, -42, -42, -41, -41, -34, -34, -38, -38, -40, -40, -41, -41]
a[12] = [0, 0, -37, -37, -39, -39, -37, -37, -41, -41, -39, -39, -35, -35, -37, -37, -32, -32, -33, -33, -38, -38, -38, -38, -35, -35, -33, -33, -37, -37, -37, -37]
a[13] = [-39, -39, -40, -40, -41, -41, -40, -40, -41, -41, -41, -41, -40, -40, -42, -42, -36, -36, -35, -35, -40, -40, -40, -40, -40, -40, -38, -38, -34, -34, -39, -39]
a[14] = [-36, -36, -38, -38, -34, -34, -39, -39, -34, -34, -32, -32, -35, -35, -30, -30, -39, -39, -37, -37, -39, -39, -38, -38, -31, -31, -35, -35, -38, -38, -37, -37]
a[15] = [-15, -15, -11, -11,  -9,  -9, -11, -11, -17, -17, -16, -16, -16,-16, -15, -15, -19, -19, -16, -16, -15, -15, -18, -18, -15, -15, -13, -13, -15, -15, -16, -16]

old_delays=numpy.array(a)

# delta delays from calibration :
# cd /home/msok/Desktop/EDA2/data/2022_01_24_calibration/update
# grep TPM 20220124b.log  | grep nano | awk '{printf("delta_delay[%d] = [",substr($1,5,2)-1);for(i=19;i<=34;i++){printf("%.2f, ",$i);}printf("]\n");}'
# delta_delay = {}
delta_delay[0] = [-0.59, -0.90, -0.80, 0.04, -0.98, -0.55, -0.87, 0.18, -0.39, 0.60, 0.29, 0.41, 0.63, -0.95, 0.26, 0.00  ]
delta_delay[1] = [-0.01, 0.41, 1.02, -0.38, 0.75, -0.17, -0.35, -0.29, 0.34, -0.29, -0.09, 0.33, 0.71, 0.11, 0.81, 0.00   ]
delta_delay[2] = [0.32, -0.12, -0.15, 0.69, -0.41, -0.22, -0.26, -0.70, 0.55, 0.07, -0.04, -0.77, 0.19, -0.43, 0.00, 0.00 ]
delta_delay[3] = [-0.26, -0.55, 1.28, 0.78, -0.21, -0.59, -0.33, 0.49, 0.56, -0.90, -0.25, 0.22, 0.33, 0.22, -1.21, 1.57  ]
delta_delay[4] = [0.25, 0.13, 0.12, 0.41, 0.17, 0.52, -0.40, 0.59, 0.69, 0.37, 0.60, -0.18, 0.21, 0.35, -0.01, 0.00       ]
delta_delay[5] = [1.74, 1.62, 2.12, 1.85, 1.22, 1.52, 1.25, 1.49, 2.19, 1.88, 2.18, 0.76, 0.67, 7.70, 0.00, 0.00          ]
delta_delay[6] = [1.26, 0.92, -0.01, 0.11, -0.78, -0.08, 0.23, 0.86, 0.71, 0.14, 0.81, 0.55, -0.08, 1.02, 0.34, 0.70      ]
delta_delay[7] = [0.53, 0.43, 0.51, 0.40, 0.86, 0.27, 1.06, -0.04, -0.22, 0.92, 0.18, 0.25, 1.05, 0.13, 1.17, 0.25        ]
delta_delay[8] = [0.18, -6.78, 0.80, 0.66, 0.13, 0.75, 0.75, -0.07, 0.74, 0.95, 0.29, 0.39, 1.18, -0.04, 0.14, 0.00       ]
delta_delay[9] = [0.29, 1.11, 0.85, 0.80, 1.65, 1.25, 1.33, 1.47, 0.98, 0.82, 1.10, 1.81, 0.61, 1.12, 21.13, 10.53        ]
delta_delay[10] = [-0.67, -0.50, -0.45, 0.90, 0.44, 0.25, 0.97, -0.23, -0.32, -0.52, 0.68, 0.27, 0.86, 0.00, 0.00, 0.00   ]
delta_delay[11] = [0.65, -0.41, -0.10, 0.08, 0.83, 0.38, 1.54, 0.07, 0.35, 0.74, 0.73, 0.35, -0.15, 0.29, 0.90, 0.00      ]
delta_delay[12] = [-29.02, 0.46, 0.77, 0.50, 1.38, -0.88, 0.60, 0.14, 0.47, 0.69, 0.35, 0.33, -0.37, 0.62, 1.46, 1.54     ]
delta_delay[13] = [0.46, -0.08, 0.32, -0.12, 1.16, -0.75, 0.04, 0.81, 0.65, 0.45, -0.16, -0.09, 0.53, 0.02, 0.45, -0.05   ]
delta_delay[14] = [0.08, 0.07, -0.28, -0.07, 0.89, 0.30, 0.60, 0.23, 0.66, -0.23, -0.42, -0.07, -0.01, 0.68, 0.00, 0.00   ]
delta_delay[15] = [-0.41, 0.30, -0.00, -0.23, 1.04, 0.05, 0.36, 0.16, 0.50, 0.32, 0.38, 0.05, 0.16, -0.13, 0.00, 0.00     ]
# delta_delay=numpy.array(delta_delay)

new_delays=[]
for tpm in range(0,NTPMs):
   delta=[]
   for dt in delta_delay[tpm] :
      delta.append(dt)
      delta.append(dt)
      
   delta = numpy.array(delta)
   c = old_delays[tpm] + delta
   new_delays.append(c)
   
print("NEW SET OF DELAYS:")      
for tpm in range(0,NTPMs):
   new = new_delays[tpm]
   
   line = "    - ["
   for idx in range(0,2*NTPMs) :
      dt = new[idx]
      if idx < (2*NTPMs-1) :
         line += ( "%.1f, " % dt )
      else :
         line += ( "%.1f ]" % dt )

   print line
   

